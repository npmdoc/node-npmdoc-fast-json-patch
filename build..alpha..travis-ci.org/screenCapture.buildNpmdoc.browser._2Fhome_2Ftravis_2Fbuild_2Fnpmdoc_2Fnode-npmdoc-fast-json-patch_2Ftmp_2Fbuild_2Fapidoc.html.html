<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/Starcounter-Jack/JSON-Patch">fast-json-patch (v1.1.8)</a>
</h1>
<h4>Fast implementation of JSON-Patch (RFC-6902) with duplex (observe changes) capabilities</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.fast-json-patch">module fast-json-patch</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.JsonPatchError">
            function <span class="apidocSignatureSpan">fast-json-patch.</span>JsonPatchError
            <span class="apidocSignatureSpan">(message, name, index, operation, tree)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.apply">
            function <span class="apidocSignatureSpan">fast-json-patch.</span>apply
            <span class="apidocSignatureSpan">(tree, patches, validate)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.compare">
            function <span class="apidocSignatureSpan">fast-json-patch.</span>compare
            <span class="apidocSignatureSpan">(tree1, tree2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.generate">
            function <span class="apidocSignatureSpan">fast-json-patch.</span>generate
            <span class="apidocSignatureSpan">(observer)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.observe">
            function <span class="apidocSignatureSpan">fast-json-patch.</span>observe
            <span class="apidocSignatureSpan">(obj, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.unobserve">
            function <span class="apidocSignatureSpan">fast-json-patch.</span>unobserve
            <span class="apidocSignatureSpan">(root, observer)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.validate">
            function <span class="apidocSignatureSpan">fast-json-patch.</span>validate
            <span class="apidocSignatureSpan">(sequence, tree)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.validator">
            function <span class="apidocSignatureSpan">fast-json-patch.</span>validator
            <span class="apidocSignatureSpan">(operation, index, tree, existingPathFragment)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">fast-json-patch.</span>JsonPatchError.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">fast-json-patch.</span>default</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">fast-json-patch.</span>json_patch</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.fast-json-patch.JsonPatchError">module fast-json-patch.JsonPatchError</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.JsonPatchError.JsonPatchError">
            function <span class="apidocSignatureSpan">fast-json-patch.</span>JsonPatchError
            <span class="apidocSignatureSpan">(message, name, index, operation, tree)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.JsonPatchError.captureStackTrace">
            function <span class="apidocSignatureSpan">fast-json-patch.JsonPatchError.</span>captureStackTrace
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">fast-json-patch.JsonPatchError.</span>stackTraceLimit</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.fast-json-patch.JsonPatchError.prototype">module fast-json-patch.JsonPatchError.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.JsonPatchError.prototype.constructor">
            function <span class="apidocSignatureSpan">fast-json-patch.JsonPatchError.prototype.</span>constructor
            <span class="apidocSignatureSpan">(message, name, index, operation, tree)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.fast-json-patch.default">module fast-json-patch.default</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.default.JsonPatchError">
            function <span class="apidocSignatureSpan">fast-json-patch.default.</span>JsonPatchError
            <span class="apidocSignatureSpan">(message, name, index, operation, tree)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.default.apply">
            function <span class="apidocSignatureSpan">fast-json-patch.default.</span>apply
            <span class="apidocSignatureSpan">(tree, patches, validate)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.default.compare">
            function <span class="apidocSignatureSpan">fast-json-patch.default.</span>compare
            <span class="apidocSignatureSpan">(tree1, tree2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.default.generate">
            function <span class="apidocSignatureSpan">fast-json-patch.default.</span>generate
            <span class="apidocSignatureSpan">(observer)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.default.observe">
            function <span class="apidocSignatureSpan">fast-json-patch.default.</span>observe
            <span class="apidocSignatureSpan">(obj, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.default.unobserve">
            function <span class="apidocSignatureSpan">fast-json-patch.default.</span>unobserve
            <span class="apidocSignatureSpan">(root, observer)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.default.validate">
            function <span class="apidocSignatureSpan">fast-json-patch.default.</span>validate
            <span class="apidocSignatureSpan">(sequence, tree)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.default.validator">
            function <span class="apidocSignatureSpan">fast-json-patch.default.</span>validator
            <span class="apidocSignatureSpan">(operation, index, tree, existingPathFragment)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.fast-json-patch.json_patch">module fast-json-patch.json_patch</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.json_patch.JsonPatchError">
            function <span class="apidocSignatureSpan">fast-json-patch.json_patch.</span>JsonPatchError
            <span class="apidocSignatureSpan">(message, name, index, operation, tree)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.json_patch.apply">
            function <span class="apidocSignatureSpan">fast-json-patch.json_patch.</span>apply
            <span class="apidocSignatureSpan">(tree, patches, validate)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.json_patch.validate">
            function <span class="apidocSignatureSpan">fast-json-patch.json_patch.</span>validate
            <span class="apidocSignatureSpan">(sequence, tree)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.fast-json-patch.json_patch.validator">
            function <span class="apidocSignatureSpan">fast-json-patch.json_patch.</span>validator
            <span class="apidocSignatureSpan">(operation, index, tree, existingPathFragment)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">fast-json-patch.json_patch.</span>default</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.fast-json-patch" id="apidoc.module.fast-json-patch">module fast-json-patch</a></h1>


    <h2>
        <a href="#apidoc.element.fast-json-patch.JsonPatchError" id="apidoc.element.fast-json-patch.JsonPatchError">
        function <span class="apidocSignatureSpan">fast-json-patch.</span>JsonPatchError
        <span class="apidocSignatureSpan">(message, name, index, operation, tree)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function JsonPatchError(message, name, index, operation, tree) {
    _super.call(this, message);
    this.message = message;
    this.name = name;
    this.index = index;
    this.operation = operation;
    this.tree = tree;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.apply" id="apidoc.element.fast-json-patch.apply">
        function <span class="apidocSignatureSpan">fast-json-patch.</span>apply
        <span class="apidocSignatureSpan">(tree, patches, validate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function apply(tree, patches, validate) {
    var results = [], p = 0, plen = patches.length, patch, key;
    while (p &lt; plen) {
        patch = patches[p];
        p++;
        // Find the object
        var path = patch.path || "";
        var keys = path.split('/');
        var obj = tree;
        var t = 1; //skip empty element - http://jsperf.com/to-shift-or-not-to-shift
        var len = keys.length;
        var existingPathFragment = undefined;
        while (true) {
            key = keys[t];
            if (validate) {
                if (existingPathFragment === undefined) {
                    if (obj[key] === undefined) {
                        existingPathFragment = keys.slice(0, t).join('/');
                    }
                    else if (t == len - 1) {
                        existingPathFragment = patch.path;
                    }
                    if (existingPathFragment !== undefined) {
                        this.validator(patch, p - 1, tree, existingPathFragment);
                    }
                }
            }
            t++;
            if (key === undefined) {
                if (t &gt;= len) {
                    results.push(rootOps[patch.op].call(patch, obj, key, tree)); // Apply patch
                    break;
                }
            }
            if (_isArray(obj)) {
                if (key === '-') {
                    key = obj.length;
                }
                else {
                    if (validate &amp;&amp; !isInteger(key)) {
                        throw new JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the
 array element with the zero-based index", "OPERATION_PATH_ILLEGAL_ARRAY_INDEX", p - 1, patch.path, patch);
                    }
                    key = parseInt(key, 10);
                }
                if (t &gt;= len) {
                    if (validate &amp;&amp; patch.op === "add" &amp;&amp; key &gt; obj.length) {
                        throw new JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array
", "OPERATION_VALUE_OUT_OF_BOUNDS", p - 1, patch.path, patch);
                    }
                    results.push(arrOps[patch.op].call(patch, obj, key, tree)); // Apply patch
                    break;
                }
            }
            else {
                if (key &amp;&amp; key.indexOf('~') != -1)
                    key = key.replace(/~1/g, '/').replace(/~0/g, '~'); // escape chars
                if (t &gt;= len) {
                    results.push(objOps[patch.op].call(patch, obj, key, tree)); // Apply patch
                    break;
                }
            }
            obj = obj[key];
        }
    }
    return results;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```js
var myobj = { firstName:"Albert", contactDetails: { phoneNumbers: [ ] } };
var patches = [
   {op:"replace", path:"/firstName", value:"Joachim" },
   {op:"add", path:"/lastName", value:"Wester" },
   {op:"add", path:"/contactDetails/phoneNumbers/0", value:{ number:"555-123" }  }
   ];
jsonpatch.<span class="apidocCodeKeywordSpan">apply</span>( myobj, patches );
// myobj == { firstName:"Joachim", lastName:"Wester", contactDetails:{ phoneNumbers[ {number:"555-123&amp;#
x22;} ] } };
```
Generating patches:

```js
var myobj = { firstName:"Joachim", lastName:"Wester", contactDetails: { phoneNumbers: [ { number:"555-123
" }] } };
observer = jsonpatch.observe( myobj );
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.compare" id="apidoc.element.fast-json-patch.compare">
        function <span class="apidocSignatureSpan">fast-json-patch.</span>compare
        <span class="apidocSignatureSpan">(tree1, tree2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function compare(tree1, tree2) {
    var patches = [];
    _generate(tree1, tree2, patches, '');
    return patches;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
//   { op:"add", path="/contactDetails/phoneNumbers/1", value:{number:"456"}}];
```
Comparing two object trees:

```js
var objA = {user: {firstName: "Albert", lastName: "Einstein"}};
var objB = {user: {firstName: "Albert", lastName: "Collins"}};
var diff = jsonpatch.<span class="apidocCodeKeywordSpan">compare</span>(objA, objB));
//diff == [{op: "replace", path: "/user/lastName", value: "Collins"}]
```

Validating a sequence of patches:

```js
var obj = {user: {firstName: "Albert"}};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.generate" id="apidoc.element.fast-json-patch.generate">
        function <span class="apidocSignatureSpan">fast-json-patch.</span>generate
        <span class="apidocSignatureSpan">(observer)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function generate(observer) {
    var mirror;
    for (var i = 0, ilen = beforeDict.length; i &lt; ilen; i++) {
        if (beforeDict[i].obj === observer.object) {
            mirror = beforeDict[i];
            break;
        }
    }
    _generate(mirror.value, observer.object, observer.patches, "");
    if (observer.patches.length) {
        apply(mirror.value, observer.patches);
    }
    var temp = observer.patches;
    if (temp.length &gt; 0) {
        observer.patches = [];
        if (observer.callback) {
            observer.callback(temp);
        }
    }
    return temp;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

```js
var myobj = { firstName:"Joachim", lastName:"Wester", contactDetails: { phoneNumbers: [ { number:"555-123
" }] } };
observer = jsonpatch.observe( myobj );
myobj.firstName = "Albert";
myobj.contactDetails.phoneNumbers[0].number = "123";
myobj.contactDetails.phoneNumbers.push({number:"456"});
var patches = jsonpatch.<span class="apidocCodeKeywordSpan">generate</span>(observer);
// patches  == [
//   { op:"replace", path="/firstName", value:"Albert"},
//   { op:"replace", path="/contactDetails/phoneNumbers/0/number", value:"123"},
//   { op:"add", path="/contactDetails/phoneNumbers/1", value:{number:"456"}}];
```
Comparing two object trees:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.observe" id="apidoc.element.fast-json-patch.observe">
        function <span class="apidocSignatureSpan">fast-json-patch.</span>observe
        <span class="apidocSignatureSpan">(obj, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function observe(obj, callback) {
    var patches = [];
    var root = obj;
    var observer;
    var mirror = getMirror(obj);
    if (!mirror) {
        mirror = new Mirror(obj);
        beforeDict.push(mirror);
    }
    else {
        observer = getObserverFromMirror(mirror, callback);
    }
    if (observer) {
        return observer;
    }
    observer = {};
    mirror.value = deepClone(obj);
    if (callback) {
        observer.callback = callback;
        observer.next = null;
        var dirtyCheck = function () {
            generate(observer);
        };
        var fastCheck = function () {
            clearTimeout(observer.next);
            observer.next = setTimeout(dirtyCheck);
        };
        if (typeof window !== 'undefined') {
            if (window.addEventListener) {
                window.addEventListener('mouseup', fastCheck);
                window.addEventListener('keyup', fastCheck);
                window.addEventListener('mousedown', fastCheck);
                window.addEventListener('keydown', fastCheck);
                window.addEventListener('change', fastCheck);
            }
            else {
                document.documentElement.attachEvent('onmouseup', fastCheck);
                document.documentElement.attachEvent('onkeyup', fastCheck);
                document.documentElement.attachEvent('onmousedown', fastCheck);
                document.documentElement.attachEvent('onkeydown', fastCheck);
                document.documentElement.attachEvent('onchange', fastCheck);
            }
        }
    }
    observer.patches = patches;
    observer.object = obj;
    observer.unobserve = function () {
        generate(observer);
        clearTimeout(observer.next);
        removeObserverFromMirror(mirror, observer);
        if (typeof window !== 'undefined') {
            if (window.removeEventListener) {
                window.removeEventListener('mouseup', fastCheck);
                window.removeEventListener('keyup', fastCheck);
                window.removeEventListener('mousedown', fastCheck);
                window.removeEventListener('keydown', fastCheck);
            }
            else {
                document.documentElement.detachEvent('onmouseup', fastCheck);
                document.documentElement.detachEvent('onkeyup', fastCheck);
                document.documentElement.detachEvent('onmousedown', fastCheck);
                document.documentElement.detachEvent('onkeydown', fastCheck);
            }
        }
    };
    mirror.observers.push(new ObserverInfo(callback, observer));
    return observer;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
jsonpatch.apply( myobj, patches );
// myobj == { firstName:"Joachim", lastName:"Wester", contactDetails:{ phoneNumbers[ {number:"555-123&amp;#
x22;} ] } };
```
Generating patches:

```js
var myobj = { firstName:"Joachim", lastName:"Wester", contactDetails: { phoneNumbers: [ { number:"555-123
" }] } };
observer = jsonpatch.<span class="apidocCodeKeywordSpan">observe</span>( myobj );
myobj.firstName = "Albert";
myobj.contactDetails.phoneNumbers[0].number = "123";
myobj.contactDetails.phoneNumbers.push({number:"456"});
var patches = jsonpatch.generate(observer);
// patches  == [
//   { op:"replace", path="/firstName", value:"Albert"},
//   { op:"replace", path="/contactDetails/phoneNumbers/0/number", value:"123"},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.unobserve" id="apidoc.element.fast-json-patch.unobserve">
        function <span class="apidocSignatureSpan">fast-json-patch.</span>unobserve
        <span class="apidocSignatureSpan">(root, observer)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function unobserve(root, observer) {
    observer.unobserve();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.validate" id="apidoc.element.fast-json-patch.validate">
        function <span class="apidocSignatureSpan">fast-json-patch.</span>validate
        <span class="apidocSignatureSpan">(sequence, tree)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function validate(sequence, tree) {
    try {
        if (!_isArray(sequence)) {
            throw new JsonPatchError('Patch sequence must be an array', 'SEQUENCE_NOT_AN_ARRAY');
        }
        if (tree) {
            tree = JSON.parse(JSON.stringify(tree)); //clone tree so that we can safely try applying operations
            apply.call(this, tree, sequence, true);
        }
        else {
            for (var i = 0; i &lt; sequence.length; i++) {
                this.validator(sequence[i], i);
            }
        }
    }
    catch (e) {
        if (e instanceof JsonPatchError) {
            return e;
        }
        else {
            throw e;
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

Validating a sequence of patches:

```js
var obj = {user: {firstName: "Albert"}};
var patches = [{op: "replace", path: "/user/firstName", value: "Albert"}, {op: "replace",
path: "/user/lastName", value: "Einstein"}];
var errors = jsonpatch.<span class="apidocCodeKeywordSpan">validate</span>(patches, obj);
if (errors.length == 0) {
 //there are no errors!
}
else {
for (var i=0; i &lt; errors.length; i++) {
  if (!errors[i]) {
    console.log("Valid patch at index", i, patches[i]);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.validator" id="apidoc.element.fast-json-patch.validator">
        function <span class="apidocSignatureSpan">fast-json-patch.</span>validator
        <span class="apidocSignatureSpan">(operation, index, tree, existingPathFragment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function validator(operation, index, tree, existingPathFragment) {
    if (typeof operation !== 'object' || operation === null || _isArray(operation)) {
        throw new JsonPatchError('Operation is not an object', 'OPERATION_NOT_AN_OBJECT', index, operation, tree);
    }
    else if (!objOps[operation.op]) {
        throw new JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902', 'OPERATION_OP_INVALID',
index, operation, tree);
    }
    else if (typeof operation.path !== 'string') {
        throw new JsonPatchError('Operation `path` property is not a string', 'OPERATION_PATH_INVALID', index, operation, tree);
    }
    else if (operation.path.indexOf('/') !== 0 &amp;&amp; operation.path.length &gt; 0) {
        // paths that aren't emptystring should start with "/"
        throw new JsonPatchError('Operation `path` property must start with "/"', 'OPERATION_PATH_INVALID', index, operation, tree
);
    }
    else if ((operation.op === 'move' || operation.op === 'copy') &amp;&amp; typeof operation.from !== 'string') {
        throw new JsonPatchError('Operation `from` property is not present (applicable in `move` and `copy` operations)', 'OPERATION_FROM_REQUIRED
', index, operation, tree);
    }
    else if ((operation.op === 'add' || operation.op === 'replace' || operation.op === 'test') &amp;&amp; operation.value === undefined) {
        throw new JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations
)', 'OPERATION_VALUE_REQUIRED', index, operation, tree);
    }
    else if ((operation.op === 'add' || operation.op === 'replace' || operation.op === 'test') &amp;&amp; hasUndefined(operation.value)) {
        throw new JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations
)', 'OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED', index, operation, tree);
    }
    else if (tree) {
        if (operation.op == "add") {
            var pathLen = operation.path.split("/").length;
            var existingPathLen = existingPathFragment.split("/").length;
            if (pathLen !== existingPathLen + 1 &amp;&amp; pathLen !== existingPathLen) {
                throw new JsonPatchError('Cannot perform an `add` operation at the desired path', 'OPERATION_PATH_CANNOT_ADD', index
, operation, tree);
            }
        }
        else if (operation.op === 'replace' || operation.op === 'remove' || operation.op === '_get') {
            if (operation.path !== existingPathFragment) {
                throw new JsonPatchError('Cannot perform the operation at a path that does not exist', 'OPERATION_PATH_UNRESOLVABLE
', index, operation, tree);
            }
        }
        else if (operation.op === 'move' || operation.op === 'copy') {
            var existingValue = { op: "_get", path: operation.from, value: undefined };
            var error = jsonpatch.validate([existingValue], tree);
            if (error &amp;&amp; error.name === 'OPERATION_PATH_UNRESOLVABLE') {
                throw new JsonPatchError('Cannot perform the operation from a path that does not exist', 'OPERATION_FROM_UNRESOLVABLE
', index, operation, tree);
            }
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        if (obj[key] === undefined) {
            existingPathFragment = keys.slice(0, t).join('/');
        }
        else if (t == len - 1) {
            existingPathFragment = patch.path;
        }
        if (existingPathFragment !== undefined) {
            this.<span class="apidocCodeKeywordSpan">validator</span>(patch, p - 1, tree, existingPathFragment);
        }
    }
}
t++;
if (key === undefined) {
    if (t &gt;= len) {
        results[p - 1] = rootOps[patch.op].call(patch, obj, key, tree); // Apply patch
...</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.fast-json-patch.JsonPatchError" id="apidoc.module.fast-json-patch.JsonPatchError">module fast-json-patch.JsonPatchError</a></h1>


    <h2>
        <a href="#apidoc.element.fast-json-patch.JsonPatchError.JsonPatchError" id="apidoc.element.fast-json-patch.JsonPatchError.JsonPatchError">
        function <span class="apidocSignatureSpan">fast-json-patch.</span>JsonPatchError
        <span class="apidocSignatureSpan">(message, name, index, operation, tree)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function JsonPatchError(message, name, index, operation, tree) {
    _super.call(this, message);
    this.message = message;
    this.name = name;
    this.index = index;
    this.operation = operation;
    this.tree = tree;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.JsonPatchError.captureStackTrace" id="apidoc.element.fast-json-patch.JsonPatchError.captureStackTrace">
        function <span class="apidocSignatureSpan">fast-json-patch.JsonPatchError.</span>captureStackTrace
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function captureStackTrace() { [native code] }</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.fast-json-patch.JsonPatchError.prototype" id="apidoc.module.fast-json-patch.JsonPatchError.prototype">module fast-json-patch.JsonPatchError.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.fast-json-patch.JsonPatchError.prototype.constructor" id="apidoc.element.fast-json-patch.JsonPatchError.prototype.constructor">
        function <span class="apidocSignatureSpan">fast-json-patch.JsonPatchError.prototype.</span>constructor
        <span class="apidocSignatureSpan">(message, name, index, operation, tree)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function JsonPatchError(message, name, index, operation, tree) {
    _super.call(this, message);
    this.message = message;
    this.name = name;
    this.index = index;
    this.operation = operation;
    this.tree = tree;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.fast-json-patch.default" id="apidoc.module.fast-json-patch.default">module fast-json-patch.default</a></h1>


    <h2>
        <a href="#apidoc.element.fast-json-patch.default.JsonPatchError" id="apidoc.element.fast-json-patch.default.JsonPatchError">
        function <span class="apidocSignatureSpan">fast-json-patch.default.</span>JsonPatchError
        <span class="apidocSignatureSpan">(message, name, index, operation, tree)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function JsonPatchError(message, name, index, operation, tree) {
    _super.call(this, message);
    this.message = message;
    this.name = name;
    this.index = index;
    this.operation = operation;
    this.tree = tree;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.default.apply" id="apidoc.element.fast-json-patch.default.apply">
        function <span class="apidocSignatureSpan">fast-json-patch.default.</span>apply
        <span class="apidocSignatureSpan">(tree, patches, validate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function apply(tree, patches, validate) {
    var results = [], p = 0, plen = patches.length, patch, key;
    while (p &lt; plen) {
        patch = patches[p];
        p++;
        // Find the object
        var path = patch.path || "";
        var keys = path.split('/');
        var obj = tree;
        var t = 1; //skip empty element - http://jsperf.com/to-shift-or-not-to-shift
        var len = keys.length;
        var existingPathFragment = undefined;
        while (true) {
            key = keys[t];
            if (validate) {
                if (existingPathFragment === undefined) {
                    if (obj[key] === undefined) {
                        existingPathFragment = keys.slice(0, t).join('/');
                    }
                    else if (t == len - 1) {
                        existingPathFragment = patch.path;
                    }
                    if (existingPathFragment !== undefined) {
                        this.validator(patch, p - 1, tree, existingPathFragment);
                    }
                }
            }
            t++;
            if (key === undefined) {
                if (t &gt;= len) {
                    results.push(rootOps[patch.op].call(patch, obj, key, tree)); // Apply patch
                    break;
                }
            }
            if (_isArray(obj)) {
                if (key === '-') {
                    key = obj.length;
                }
                else {
                    if (validate &amp;&amp; !isInteger(key)) {
                        throw new JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the
 array element with the zero-based index", "OPERATION_PATH_ILLEGAL_ARRAY_INDEX", p - 1, patch.path, patch);
                    }
                    key = parseInt(key, 10);
                }
                if (t &gt;= len) {
                    if (validate &amp;&amp; patch.op === "add" &amp;&amp; key &gt; obj.length) {
                        throw new JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array
", "OPERATION_VALUE_OUT_OF_BOUNDS", p - 1, patch.path, patch);
                    }
                    results.push(arrOps[patch.op].call(patch, obj, key, tree)); // Apply patch
                    break;
                }
            }
            else {
                if (key &amp;&amp; key.indexOf('~') != -1)
                    key = key.replace(/~1/g, '/').replace(/~0/g, '~'); // escape chars
                if (t &gt;= len) {
                    results.push(objOps[patch.op].call(patch, obj, key, tree)); // Apply patch
                    break;
                }
            }
            obj = obj[key];
        }
    }
    return results;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```js
var myobj = { firstName:"Albert", contactDetails: { phoneNumbers: [ ] } };
var patches = [
   {op:"replace", path:"/firstName", value:"Joachim" },
   {op:"add", path:"/lastName", value:"Wester" },
   {op:"add", path:"/contactDetails/phoneNumbers/0", value:{ number:"555-123" }  }
   ];
jsonpatch.<span class="apidocCodeKeywordSpan">apply</span>( myobj, patches );
// myobj == { firstName:"Joachim", lastName:"Wester", contactDetails:{ phoneNumbers[ {number:"555-123&amp;#
x22;} ] } };
```
Generating patches:

```js
var myobj = { firstName:"Joachim", lastName:"Wester", contactDetails: { phoneNumbers: [ { number:"555-123
" }] } };
observer = jsonpatch.observe( myobj );
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.default.compare" id="apidoc.element.fast-json-patch.default.compare">
        function <span class="apidocSignatureSpan">fast-json-patch.default.</span>compare
        <span class="apidocSignatureSpan">(tree1, tree2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function compare(tree1, tree2) {
    var patches = [];
    _generate(tree1, tree2, patches, '');
    return patches;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
//   { op:"add", path="/contactDetails/phoneNumbers/1", value:{number:"456"}}];
```
Comparing two object trees:

```js
var objA = {user: {firstName: "Albert", lastName: "Einstein"}};
var objB = {user: {firstName: "Albert", lastName: "Collins"}};
var diff = jsonpatch.<span class="apidocCodeKeywordSpan">compare</span>(objA, objB));
//diff == [{op: "replace", path: "/user/lastName", value: "Collins"}]
```

Validating a sequence of patches:

```js
var obj = {user: {firstName: "Albert"}};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.default.generate" id="apidoc.element.fast-json-patch.default.generate">
        function <span class="apidocSignatureSpan">fast-json-patch.default.</span>generate
        <span class="apidocSignatureSpan">(observer)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function generate(observer) {
    var mirror;
    for (var i = 0, ilen = beforeDict.length; i &lt; ilen; i++) {
        if (beforeDict[i].obj === observer.object) {
            mirror = beforeDict[i];
            break;
        }
    }
    _generate(mirror.value, observer.object, observer.patches, "");
    if (observer.patches.length) {
        apply(mirror.value, observer.patches);
    }
    var temp = observer.patches;
    if (temp.length &gt; 0) {
        observer.patches = [];
        if (observer.callback) {
            observer.callback(temp);
        }
    }
    return temp;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

```js
var myobj = { firstName:"Joachim", lastName:"Wester", contactDetails: { phoneNumbers: [ { number:"555-123
" }] } };
observer = jsonpatch.observe( myobj );
myobj.firstName = "Albert";
myobj.contactDetails.phoneNumbers[0].number = "123";
myobj.contactDetails.phoneNumbers.push({number:"456"});
var patches = jsonpatch.<span class="apidocCodeKeywordSpan">generate</span>(observer);
// patches  == [
//   { op:"replace", path="/firstName", value:"Albert"},
//   { op:"replace", path="/contactDetails/phoneNumbers/0/number", value:"123"},
//   { op:"add", path="/contactDetails/phoneNumbers/1", value:{number:"456"}}];
```
Comparing two object trees:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.default.observe" id="apidoc.element.fast-json-patch.default.observe">
        function <span class="apidocSignatureSpan">fast-json-patch.default.</span>observe
        <span class="apidocSignatureSpan">(obj, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function observe(obj, callback) {
    var patches = [];
    var root = obj;
    var observer;
    var mirror = getMirror(obj);
    if (!mirror) {
        mirror = new Mirror(obj);
        beforeDict.push(mirror);
    }
    else {
        observer = getObserverFromMirror(mirror, callback);
    }
    if (observer) {
        return observer;
    }
    observer = {};
    mirror.value = deepClone(obj);
    if (callback) {
        observer.callback = callback;
        observer.next = null;
        var dirtyCheck = function () {
            generate(observer);
        };
        var fastCheck = function () {
            clearTimeout(observer.next);
            observer.next = setTimeout(dirtyCheck);
        };
        if (typeof window !== 'undefined') {
            if (window.addEventListener) {
                window.addEventListener('mouseup', fastCheck);
                window.addEventListener('keyup', fastCheck);
                window.addEventListener('mousedown', fastCheck);
                window.addEventListener('keydown', fastCheck);
                window.addEventListener('change', fastCheck);
            }
            else {
                document.documentElement.attachEvent('onmouseup', fastCheck);
                document.documentElement.attachEvent('onkeyup', fastCheck);
                document.documentElement.attachEvent('onmousedown', fastCheck);
                document.documentElement.attachEvent('onkeydown', fastCheck);
                document.documentElement.attachEvent('onchange', fastCheck);
            }
        }
    }
    observer.patches = patches;
    observer.object = obj;
    observer.unobserve = function () {
        generate(observer);
        clearTimeout(observer.next);
        removeObserverFromMirror(mirror, observer);
        if (typeof window !== 'undefined') {
            if (window.removeEventListener) {
                window.removeEventListener('mouseup', fastCheck);
                window.removeEventListener('keyup', fastCheck);
                window.removeEventListener('mousedown', fastCheck);
                window.removeEventListener('keydown', fastCheck);
            }
            else {
                document.documentElement.detachEvent('onmouseup', fastCheck);
                document.documentElement.detachEvent('onkeyup', fastCheck);
                document.documentElement.detachEvent('onmousedown', fastCheck);
                document.documentElement.detachEvent('onkeydown', fastCheck);
            }
        }
    };
    mirror.observers.push(new ObserverInfo(callback, observer));
    return observer;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
jsonpatch.apply( myobj, patches );
// myobj == { firstName:"Joachim", lastName:"Wester", contactDetails:{ phoneNumbers[ {number:"555-123&amp;#
x22;} ] } };
```
Generating patches:

```js
var myobj = { firstName:"Joachim", lastName:"Wester", contactDetails: { phoneNumbers: [ { number:"555-123
" }] } };
observer = jsonpatch.<span class="apidocCodeKeywordSpan">observe</span>( myobj );
myobj.firstName = "Albert";
myobj.contactDetails.phoneNumbers[0].number = "123";
myobj.contactDetails.phoneNumbers.push({number:"456"});
var patches = jsonpatch.generate(observer);
// patches  == [
//   { op:"replace", path="/firstName", value:"Albert"},
//   { op:"replace", path="/contactDetails/phoneNumbers/0/number", value:"123"},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.default.unobserve" id="apidoc.element.fast-json-patch.default.unobserve">
        function <span class="apidocSignatureSpan">fast-json-patch.default.</span>unobserve
        <span class="apidocSignatureSpan">(root, observer)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function unobserve(root, observer) {
    observer.unobserve();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.default.validate" id="apidoc.element.fast-json-patch.default.validate">
        function <span class="apidocSignatureSpan">fast-json-patch.default.</span>validate
        <span class="apidocSignatureSpan">(sequence, tree)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function validate(sequence, tree) {
    try {
        if (!_isArray(sequence)) {
            throw new JsonPatchError('Patch sequence must be an array', 'SEQUENCE_NOT_AN_ARRAY');
        }
        if (tree) {
            tree = JSON.parse(JSON.stringify(tree)); //clone tree so that we can safely try applying operations
            apply.call(this, tree, sequence, true);
        }
        else {
            for (var i = 0; i &lt; sequence.length; i++) {
                this.validator(sequence[i], i);
            }
        }
    }
    catch (e) {
        if (e instanceof JsonPatchError) {
            return e;
        }
        else {
            throw e;
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

Validating a sequence of patches:

```js
var obj = {user: {firstName: "Albert"}};
var patches = [{op: "replace", path: "/user/firstName", value: "Albert"}, {op: "replace",
path: "/user/lastName", value: "Einstein"}];
var errors = jsonpatch.<span class="apidocCodeKeywordSpan">validate</span>(patches, obj);
if (errors.length == 0) {
 //there are no errors!
}
else {
for (var i=0; i &lt; errors.length; i++) {
  if (!errors[i]) {
    console.log("Valid patch at index", i, patches[i]);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.default.validator" id="apidoc.element.fast-json-patch.default.validator">
        function <span class="apidocSignatureSpan">fast-json-patch.default.</span>validator
        <span class="apidocSignatureSpan">(operation, index, tree, existingPathFragment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function validator(operation, index, tree, existingPathFragment) {
    if (typeof operation !== 'object' || operation === null || _isArray(operation)) {
        throw new JsonPatchError('Operation is not an object', 'OPERATION_NOT_AN_OBJECT', index, operation, tree);
    }
    else if (!objOps[operation.op]) {
        throw new JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902', 'OPERATION_OP_INVALID',
index, operation, tree);
    }
    else if (typeof operation.path !== 'string') {
        throw new JsonPatchError('Operation `path` property is not a string', 'OPERATION_PATH_INVALID', index, operation, tree);
    }
    else if (operation.path.indexOf('/') !== 0 &amp;&amp; operation.path.length &gt; 0) {
        // paths that aren't emptystring should start with "/"
        throw new JsonPatchError('Operation `path` property must start with "/"', 'OPERATION_PATH_INVALID', index, operation, tree
);
    }
    else if ((operation.op === 'move' || operation.op === 'copy') &amp;&amp; typeof operation.from !== 'string') {
        throw new JsonPatchError('Operation `from` property is not present (applicable in `move` and `copy` operations)', 'OPERATION_FROM_REQUIRED
', index, operation, tree);
    }
    else if ((operation.op === 'add' || operation.op === 'replace' || operation.op === 'test') &amp;&amp; operation.value === undefined) {
        throw new JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations
)', 'OPERATION_VALUE_REQUIRED', index, operation, tree);
    }
    else if ((operation.op === 'add' || operation.op === 'replace' || operation.op === 'test') &amp;&amp; hasUndefined(operation.value)) {
        throw new JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations
)', 'OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED', index, operation, tree);
    }
    else if (tree) {
        if (operation.op == "add") {
            var pathLen = operation.path.split("/").length;
            var existingPathLen = existingPathFragment.split("/").length;
            if (pathLen !== existingPathLen + 1 &amp;&amp; pathLen !== existingPathLen) {
                throw new JsonPatchError('Cannot perform an `add` operation at the desired path', 'OPERATION_PATH_CANNOT_ADD', index
, operation, tree);
            }
        }
        else if (operation.op === 'replace' || operation.op === 'remove' || operation.op === '_get') {
            if (operation.path !== existingPathFragment) {
                throw new JsonPatchError('Cannot perform the operation at a path that does not exist', 'OPERATION_PATH_UNRESOLVABLE
', index, operation, tree);
            }
        }
        else if (operation.op === 'move' || operation.op === 'copy') {
            var existingValue = { op: "_get", path: operation.from, value: undefined };
            var error = jsonpatch.validate([existingValue], tree);
            if (error &amp;&amp; error.name === 'OPERATION_PATH_UNRESOLVABLE') {
                throw new JsonPatchError('Cannot perform the operation from a path that does not exist', 'OPERATION_FROM_UNRESOLVABLE
', index, operation, tree);
            }
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        if (obj[key] === undefined) {
            existingPathFragment = keys.slice(0, t).join('/');
        }
        else if (t == len - 1) {
            existingPathFragment = patch.path;
        }
        if (existingPathFragment !== undefined) {
            this.<span class="apidocCodeKeywordSpan">validator</span>(patch, p - 1, tree, existingPathFragment);
        }
    }
}
t++;
if (key === undefined) {
    if (t &gt;= len) {
        results[p - 1] = rootOps[patch.op].call(patch, obj, key, tree); // Apply patch
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.fast-json-patch.json_patch" id="apidoc.module.fast-json-patch.json_patch">module fast-json-patch.json_patch</a></h1>


    <h2>
        <a href="#apidoc.element.fast-json-patch.json_patch.JsonPatchError" id="apidoc.element.fast-json-patch.json_patch.JsonPatchError">
        function <span class="apidocSignatureSpan">fast-json-patch.json_patch.</span>JsonPatchError
        <span class="apidocSignatureSpan">(message, name, index, operation, tree)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function JsonPatchError(message, name, index, operation, tree) {
    _super.call(this, message);
    this.message = message;
    this.name = name;
    this.index = index;
    this.operation = operation;
    this.tree = tree;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.json_patch.apply" id="apidoc.element.fast-json-patch.json_patch.apply">
        function <span class="apidocSignatureSpan">fast-json-patch.json_patch.</span>apply
        <span class="apidocSignatureSpan">(tree, patches, validate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function apply(tree, patches, validate) {
    var results = new Array(patches.length), p = 0, plen = patches.length, patch, key;
    while (p &lt; plen) {
        patch = patches[p];
        p++;
        // Find the object
        var path = patch.path || "";
        var keys = path.split('/');
        var obj = tree;
        var t = 1; //skip empty element - http://jsperf.com/to-shift-or-not-to-shift
        var len = keys.length;
        var existingPathFragment = undefined;
        while (true) {
            key = keys[t];
            if (validate) {
                if (existingPathFragment === undefined) {
                    if (obj[key] === undefined) {
                        existingPathFragment = keys.slice(0, t).join('/');
                    }
                    else if (t == len - 1) {
                        existingPathFragment = patch.path;
                    }
                    if (existingPathFragment !== undefined) {
                        this.validator(patch, p - 1, tree, existingPathFragment);
                    }
                }
            }
            t++;
            if (key === undefined) {
                if (t &gt;= len) {
                    results[p - 1] = rootOps[patch.op].call(patch, obj, key, tree); // Apply patch
                    break;
                }
            }
            if (_isArray(obj)) {
                if (key === '-') {
                    key = obj.length;
                }
                else {
                    if (validate &amp;&amp; !isInteger(key)) {
                        throw new JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the
 array element with the zero-based index", "OPERATION_PATH_ILLEGAL_ARRAY_INDEX", p - 1, patch.path, patch);
                    }
                    key = parseInt(key, 10);
                }
                if (t &gt;= len) {
                    if (validate &amp;&amp; patch.op === "add" &amp;&amp; key &gt; obj.length) {
                        throw new JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array
", "OPERATION_VALUE_OUT_OF_BOUNDS", p - 1, patch.path, patch);
                    }
                    results[p - 1] = arrOps[patch.op].call(patch, obj, key, tree); // Apply patch
                    break;
                }
            }
            else {
                if (key &amp;&amp; key.indexOf('~') != -1)
                    key = key.replace(/~1/g, '/').replace(/~0/g, '~'); // escape chars
                if (t &gt;= len) {
                    results[p - 1] = objOps[patch.op].call(patch, obj, key, tree); // Apply patch
                    break;
                }
            }
            obj = obj[key];
        }
    }
    return results;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```js
var myobj = { firstName:"Albert", contactDetails: { phoneNumbers: [ ] } };
var patches = [
   {op:"replace", path:"/firstName", value:"Joachim" },
   {op:"add", path:"/lastName", value:"Wester" },
   {op:"add", path:"/contactDetails/phoneNumbers/0", value:{ number:"555-123" }  }
   ];
jsonpatch.<span class="apidocCodeKeywordSpan">apply</span>( myobj, patches );
// myobj == { firstName:"Joachim", lastName:"Wester", contactDetails:{ phoneNumbers[ {number:"555-123&amp;#
x22;} ] } };
```
Generating patches:

```js
var myobj = { firstName:"Joachim", lastName:"Wester", contactDetails: { phoneNumbers: [ { number:"555-123
" }] } };
observer = jsonpatch.observe( myobj );
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.json_patch.validate" id="apidoc.element.fast-json-patch.json_patch.validate">
        function <span class="apidocSignatureSpan">fast-json-patch.json_patch.</span>validate
        <span class="apidocSignatureSpan">(sequence, tree)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function validate(sequence, tree) {
    try {
        if (!_isArray(sequence)) {
            throw new JsonPatchError('Patch sequence must be an array', 'SEQUENCE_NOT_AN_ARRAY');
        }
        if (tree) {
            tree = JSON.parse(JSON.stringify(tree)); //clone tree so that we can safely try applying operations
            apply.call(this, tree, sequence, true);
        }
        else {
            for (var i = 0; i &lt; sequence.length; i++) {
                this.validator(sequence[i], i);
            }
        }
    }
    catch (e) {
        if (e instanceof JsonPatchError) {
            return e;
        }
        else {
            throw e;
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

Validating a sequence of patches:

```js
var obj = {user: {firstName: "Albert"}};
var patches = [{op: "replace", path: "/user/firstName", value: "Albert"}, {op: "replace",
path: "/user/lastName", value: "Einstein"}];
var errors = jsonpatch.<span class="apidocCodeKeywordSpan">validate</span>(patches, obj);
if (errors.length == 0) {
 //there are no errors!
}
else {
for (var i=0; i &lt; errors.length; i++) {
  if (!errors[i]) {
    console.log("Valid patch at index", i, patches[i]);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.fast-json-patch.json_patch.validator" id="apidoc.element.fast-json-patch.json_patch.validator">
        function <span class="apidocSignatureSpan">fast-json-patch.json_patch.</span>validator
        <span class="apidocSignatureSpan">(operation, index, tree, existingPathFragment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function validator(operation, index, tree, existingPathFragment) {
    if (typeof operation !== 'object' || operation === null || _isArray(operation)) {
        throw new JsonPatchError('Operation is not an object', 'OPERATION_NOT_AN_OBJECT', index, operation, tree);
    }
    else if (!objOps[operation.op]) {
        throw new JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902', 'OPERATION_OP_INVALID',
index, operation, tree);
    }
    else if (typeof operation.path !== 'string') {
        throw new JsonPatchError('Operation `path` property is not a string', 'OPERATION_PATH_INVALID', index, operation, tree);
    }
    else if (operation.path.indexOf('/') !== 0 &amp;&amp; operation.path.length &gt; 0) {
        // paths that aren't emptystring should start with "/"
        throw new JsonPatchError('Operation `path` property must start with "/"', 'OPERATION_PATH_INVALID', index, operation, tree
);
    }
    else if ((operation.op === 'move' || operation.op === 'copy') &amp;&amp; typeof operation.from !== 'string') {
        throw new JsonPatchError('Operation `from` property is not present (applicable in `move` and `copy` operations)', 'OPERATION_FROM_REQUIRED
', index, operation, tree);
    }
    else if ((operation.op === 'add' || operation.op === 'replace' || operation.op === 'test') &amp;&amp; operation.value === undefined) {
        throw new JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations
)', 'OPERATION_VALUE_REQUIRED', index, operation, tree);
    }
    else if ((operation.op === 'add' || operation.op === 'replace' || operation.op === 'test') &amp;&amp; hasUndefined(operation.value)) {
        throw new JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations
)', 'OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED', index, operation, tree);
    }
    else if (tree) {
        if (operation.op == "add") {
            var pathLen = operation.path.split("/").length;
            var existingPathLen = existingPathFragment.split("/").length;
            if (pathLen !== existingPathLen + 1 &amp;&amp; pathLen !== existingPathLen) {
                throw new JsonPatchError('Cannot perform an `add` operation at the desired path', 'OPERATION_PATH_CANNOT_ADD', index
, operation, tree);
            }
        }
        else if (operation.op === 'replace' || operation.op === 'remove' || operation.op === '_get') {
            if (operation.path !== existingPathFragment) {
                throw new JsonPatchError('Cannot perform the operation at a path that does not exist', 'OPERATION_PATH_UNRESOLVABLE
', index, operation, tree);
            }
        }
        else if (operation.op === 'move' || operation.op === 'copy') {
            var existingValue = { op: "_get", path: operation.from, value: undefined };
            var error = jsonpatch.validate([existingValue], tree);
            if (error &amp;&amp; error.name === 'OPERATION_PATH_UNRESOLVABLE') {
                throw new JsonPatchError('Cannot perform the operation from a path that does not exist', 'OPERATION_FROM_UNRESOLVABLE
', index, operation, tree);
            }
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        if (obj[key] === undefined) {
            existingPathFragment = keys.slice(0, t).join('/');
        }
        else if (t == len - 1) {
            existingPathFragment = patch.path;
        }
        if (existingPathFragment !== undefined) {
            this.<span class="apidocCodeKeywordSpan">validator</span>(patch, p - 1, tree, existingPathFragment);
        }
    }
}
t++;
if (key === undefined) {
    if (t &gt;= len) {
        results[p - 1] = rootOps[patch.op].call(patch, obj, key, tree); // Apply patch
...</pre></li>
    </ul>




</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>